function e(e,t){return e?parseFloat(getComputedStyle(e)[t]):0}let t=0;const n={translateX:"px",translateY:"px",scale:"",scaleX:"",scaleY:""},o={translateX:0,translateY:0,scale:1,scaleX:1,scaleY:1},r=Object.assign(Object.assign({},n),{marginBottom:"px",marginTop:"px",marginLeft:"px",marginRight:"px",paddingBottom:"px",paddingTop:"px",paddingLeft:"px",paddingRight:"px",borderBottomWidth:"px",borderTopWidth:"px",borderLeftWidth:"px",borderRightWidth:"px",height:"px",width:"px",maxHeight:"px",maxWidth:"px",rowGap:"px",columnGap:"px",opacity:""});function i(e){return e in n}let l=new Map,a=new Map;function c(e){t=0;let n=!1;for(let[t,o]of l.entries())s(e,t,o)&&(n=!0);n&&(t=requestAnimationFrame(c))}function s(e,t,n){if(0!==n.pendingCount){n.updatedTransforms=0;for(let t=n.allTransforms.length-1;t>=0;--t)d(e,n,n.allTransforms[t],t);if(0!==n.updatedTransforms){const e=n.transformValues;t.style.transform=`translate(${e.translateX}px, ${e.translateY}px) scale(${e.scale*e.scaleX}, ${e.scale*e.scaleY})`}return 0===n.allTransforms.length?(l.delete(t),a.delete(t)):0===n.pendingCount&&l.delete(t),n.pendingCount>0}}function d(e,t,n,o){if(n.pending){if(n.startTime){const r=e>=n.endTime?1:(e-n.startTime)/n.durationMs;n.currentValue=r*n.targetValue+(1-r)*n.startValue,r>=1&&(t.pendingCount-=1,n.pending=!1,n.currentValue===n.clearValue&&t.allTransforms.splice(o,1))}else n.startTime=e,n.endTime=e+n.durationMs;i(n.prop)?(t.transformValues[n.prop]=n.currentValue,t.updatedTransforms+=1):n.pending||n.currentValue!==n.clearValue?n.elem.style[n.prop]=`${n.currentValue}${n.unit}`:n.elem.style[n.prop]=""}}function u(e,t,n){return"current"===e?t:"base"===e?n:"function"==typeof e?e(t,n):e}function f(n,s,d,f,p=100){var g,m,h;const v=a.get(n),E=function(e,t){const n=a.get(e);return null==n?void 0:n.allTransforms.find(e=>e.prop===t)}(n,s),P=null!==(g=null==E?void 0:E.clearValue)&&void 0!==g?g:function(t,n){return i(n)?o[n]:""===t.style[n]?e(t,n):NaN}(n,s),y=null!==(m=null==E?void 0:E.currentValue)&&void 0!==m?m:function(t,n){return i(n)?o[n]:e(t,n)}(n,s),x=u(d,y,P),D=void 0===f?x:u(f,y,P);D===x&&(p=0);const b=1-Number(null!==(h=null==E?void 0:E.pending)&&void 0!==h?h:0),T=Object.assign(null!=E?E:{elem:n,prop:s,unit:r[s],clearValue:P},{startValue:x,targetValue:D,durationMs:p,currentValue:x,pending:!0,startTime:null,endTime:null});v&&!E&&v.allTransforms.push(T);const w=null!=v?v:{pendingCount:0,updatedTransforms:0,transformValues:Object.create(o),allTransforms:[T],resolveOnFinish:null};w.pendingCount+=b,a.set(n,w),l.set(n,w),t||(t=requestAnimationFrame(c))}const p="__omicronDragAndDropData__";var g;!function(e){e[e.PreDrag=0]="PreDrag",e[e.PendingDrag=1]="PendingDrag",e[e.AfterDrag=2]="AfterDrag"}(g||(g={}));class m extends Error{constructor(e){super(`Drag state assertion failed: expected state ${g[e]}, but actual is ${h?g[h.state]:"<no drag>"}`)}}let h=null;function v(e){h=e}function E(e){for(let t=0;t<e.children.length;++t)if("none"!==getComputedStyle(e.children[t]).display)return t;return 0}function P(e){var t;const n=null==h?void 0:h.floatEl,o=(null==h?void 0:h.state)===g.PendingDrag?null===(t=h.to)||void 0===t?void 0:t.placeholderEl:void 0;for(let t=e.children.length-1;t>=0;--t){const r=e.children[t];if(r!==n&&r!==o&&"none"!==getComputedStyle(r).display)return t+1}return 0}function y(e){const t=getComputedStyle(e);return("static"===t.position||"relative"===t.position)&&"none"!==t.display}function x(e){for(let t=e.previousElementSibling;t;t=t.previousElementSibling)if(y(t))return t}function D(e){for(let t=e.nextElementSibling;t;t=t.nextElementSibling)if(getComputedStyle(t),y(t))return t}var b,T;(T=b||(b={}))[T.Move=0]="Move",T[T.Copy=1]="Copy";const w=["height","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth"];function I(t){return"border-box"===getComputedStyle(t).boxSizing?e(t,"height"):w.reduce((n,o)=>n+e(t,o),0)}function S(t,n){var o;const r=null===(o=null!=t?t:n)||void 0===o?void 0:o.parentElement;if(!r)return 0;const i=e(t,"marginBottom"),l=e(n,"marginTop"),a=getComputedStyle(r);return"flex"===a.display||"inline-flex"===a.display?i+l+(parseFloat(a.rowGap)||0):Math.max(i,l)}function C(e){return-(I(e)+function(e){return S(x(e),e)}(e)+function(e){return S(e,D(e))}(e))}function k(e){return S(x(e),D(e))}function M(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);let t,n;if(h.dragKind===b.Move&&e.containerEl===h.from.containerEl&&e.eventualIndex===h.from.index)t=x(h.pickedEl),n=D(h.pickedEl);else{const o=E(e.containerEl),r=P(e.containerEl);e.insertionIndex<r?(n=e.containerEl.children[e.insertionIndex],t=x(n)):(n=void 0,t=r>o?e.containerEl.children[r-1]:void 0)}const o=S(t,n),r=S(t,e.placeholderEl),i=S(e.placeholderEl,n);return I(e.placeholderEl)+r+i-o}function O(e,t,n,o=!0){if(!h)return;const{pickedToPlaceholderOffset:r,gapToPlaceholderOffset:i}=function(e){var t;const n=e.pickedElToGapOffset,o=e.state===g.PendingDrag&&(null===(t=e.to)||void 0===t?void 0:t.gapToPlaceholderOffset)||0;return{pickedToGapOffset:n,pickedToPlaceholderOffset:n+o,gapToPlaceholderOffset:o}}(h),l=P(e)-1,a=Math.min(l,Math.min(n,t)),c=o?l:Math.min(l,Math.max(n,t));if(-1===l)return;const s=e[p].options.animationTimeMs;for(let t=a;t<=c;++t){let o=e.children[t];if(h.dragKind===b.Move&&o===h.pickedEl)continue;let l,a=h.dragKind===b.Move&&e===h.from.containerEl&&t>=h.from.index,c=a?t>n:t>=n;l=c&&a?r:c?i:a?h.pickedElToGapOffset:0,f(o,"translateY","current",l,s)}}function F(e){e.stopPropagation(),e.preventDefault(),document.removeEventListener("click",F,!0)}function L(){document.removeEventListener("click",F,!0)}function B(e){!h||h.touchDrag&&h.state===g.PreDrag||e.cancelable&&e.preventDefault()}function Y(e){e.cancelable&&e.preventDefault()}const A={passive:!1,capture:!1};function V(e,t,n){const o=e?HTMLElement.prototype.addEventListener:HTMLElement.prototype.removeEventListener;for(const[e,r]of n)o.call(t,e,r,A)}class G{constructor(){this.forbiddenInsertionIndicesCache=new Map}isForbiddenIndex(e,t,n){return this.getForbiddenInsertionIndices(e,t).has(n)}furthestAllowedInsertionIndex(e,t,n,o){const r=this.getForbiddenInsertionIndices(e,t),i=o<n?1:-1;for(let e=o;e!==n;e+=i)if(!r.has(e))return e;return n}getForbiddenInsertionIndices(e,t){let n=this.forbiddenInsertionIndicesCache.get(e);if(n)return n;const o=e[p].options.forbiddenInsertionIndicesFn;let r;return r="function"==typeof o?new Set(o(e,t)):new Set,this.forbiddenInsertionIndicesCache.set(e,r),r}}const $=[];function H(e,t){return t.domDepth-e.domDepth}function K(e,t){return h&&e===h.from.containerEl&&h.dragKind===b.Move&&t>h.from.index?t-1:t}class R{constructor(){this.draggableSelector=null,this.filterSelector=null,this.handleSelector=null,this.allowPull=b.Move,this.allowDrop=!0,this.minimalMoveMouse=5,this.delay=220,this.enterGuardLeft=0,this.enterGuardLeftPx=0,this.enterGuardRight=0,this.enterGuardRightPx=0,this.animationTimeMs=100,this.floatToPlaceAnimationTimeMs=200,this.animatePadding=!0,this.keepPositionOnDragStart=!0,this.forbiddenInsertionIndicesFn=null,this.floatElScale=1,this.setWebkitTapHighlightColorTransparent=!0,this.dragStartVibration=25,this.onBeforePreDrag=null,this.onPreDragStart=null,this.onBeforeDragStart=null,this.onFloatElementCreated=null,this.onDragStart=null,this.onContainerEntered=null,this.onContainerLeft=null,this.onInternalChange=null,this.onDropToOtherContainer=null,this.onDropFromOtherContainer=null,this.onDragFinished=null}}let W;const X=new Map;function z(e){let t=X.get(e);return t||(t=function(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);const t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.zIndex="1",t.style.userSelect="none",t.style.pointerEvents="none",t.style.transformOrigin="top center",t.classList.add("drag-placeholder"),e.appendChild(t),f(t,"opacity",0);const n=getComputedStyle(t);"none"===n.backgroundImage&&"rgba(0, 0, 0, 0)"===n.backgroundColor&&(t.style.background="lightgray");let o=n.height;return o&&"0px"!==o||(t.style.height=Math.min(h.initialPickupRect.height-16,200)+"px"),t.style.left=h.pickedEl.offsetLeft+"px",t.style.right=h.pickedEl.offsetLeft+"px",t}(e),X.set(e,t)),t}let j=0,q=[],U=[],N=null;function _(e,t,n,o){U.push({scrollerIndex:q.indexOf(e),scrollerEl:e.el,horizontal:t,vertical:n,speedInput:o,snap:e.snap})}const J=.7-.3;function Q(e){var t;if(j=0,0!==U.length){if(N){let t=e-N;for(let e of U){if(e.snap)continue;const n=.3+e.speedInput*J;if(e.vertical){const o=e.scrollerEl.scrollTop,r=e.vertical*n*t;e.scrollerEl.scrollTop+=r;const i=e.scrollerEl.scrollTop-o;0!==i&&Z(e.scrollerIndex,i,0)}if(e.horizontal){const o=e.scrollerEl.scrollLeft,r=e.horizontal*n*t;e.scrollerEl.scrollLeft+=r;const i=e.scrollerEl.scrollLeft-o;0!==i&&Z(e.scrollerIndex,0,i)}}}for(let e of U){if(!e.snap)continue;const n=null!==(t=null==h?void 0:h.recentSnapScrollActivations.get(e.scrollerEl))&&void 0!==t?t:0,o=Date.now();o>n+500&&(e.horizontal&&(e.scrollerEl.scrollLeft+=e.horizontal*e.scrollerEl.clientWidth),e.vertical&&(e.scrollerEl.scrollTop+=e.vertical*e.scrollerEl.clientHeight),null==h||h.recentSnapScrollActivations.set(e.scrollerEl,o))}N=e,j=requestAnimationFrame(Q)}}function Z(e,t,n){for(let o=0;o<e;++o){const e=q[o].rect;e.top-=t,e.bottom-=t,e.left-=n,e.right-=n}}const ee=60;let te,ne=0;function oe(e){ne=0,h&&h.state===g.PendingDrag&&(h.floatEl.style.transform=`translate(${h.floatElPos.x}px,${h.floatElPos.y}px) scale(${h.floatElScale})`)}function re(e,t){V(e,document,t?[["touchstart",ce],["touchmove",se],["touchend",de],["touchcancel",de],["pointermove",Y]]:[["pointermove",ue],["pointerup",fe],["pointercancel",fe]])}function ie(e,t){V(e,document,t?[["touchstart",pe],["touchmove",ge],["touchend",Te],["touchcancel",be],["pointermove",Y]]:[["pointermove",me],["pointerup",Ie],["pointercancel",we]]),V(e,document,[["selectstart",Y]])}function le(e){const t=e.currentTarget;if(function(e){for(let t=e.parentElement;t;t=t.parentElement)if(p in t)return!0;return!1}(t)||e.stopPropagation(),h)return;if("mouse"===e.pointerType&&1!==e.buttons)return;const n="touch"===e.pointerType,o=t[p],r=o.options;if(!1===r.allowPull)return;let i=r.allowPull;const l=function(e,t){var n;let o=e.currentTarget,r=null,i=!1;for(let n=e.target;n!==o;n=n.parentElement){if(t.filterSelector&&n.matches(t.filterSelector))return null;t.handleSelector&&n.matches(t.handleSelector)&&(i=!0),r=n}return!r||(null==h?void 0:h.state)===g.PendingDrag&&r===(null===(n=h.to)||void 0===n?void 0:n.placeholderEl)||t.draggableSelector&&!r.matches(t.draggableSelector)||!i&&t.handleSelector?null:r}(e,o.options);if(!l)return;if("function"==typeof r.onBeforePreDrag){const n=r.onBeforePreDrag(t,l,e);switch(n){case!1:return;case b.Move:case b.Copy:i=n}}e.stopPropagation();const a={containerEl:t,index:Array.from(t.children).indexOf(l)};re(!0,n);const c=l.getClientRects()[0],s={x:e.clientX,y:e.clientY},d={x:c.x-s.x+16,y:c.y-s.y-4},u=C(l),f=u+k(l),m=r.delay,E=setTimeout(ae,m);"function"==typeof r.onPreDragStart&&r.onPreDragStart(t,l,e),te||(te={bodyUserSelect:document.body.style.userSelect,bodyWebkitUserSelect:document.body.style.webkitUserSelect,bodyWebkitTouchCallout:document.body.style.webkitTouchCallout},document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",document.body.style.webkitTouchCallout="none");const P=e.target;P.setPointerCapture(e.pointerId),v({state:g.PreDrag,pointerId:e.pointerId,pointerDownTarget:P,touchDrag:n,from:a,dragKind:i,pickedEl:l,pickedElToNothingOffset:u,pickedElToGapOffset:f,initialPickupRect:c,pickupPointerPos:s,floatFromPointerOffset:d,currentPointerPos:s,floatElScale:r.floatElScale,minimalMoveMouse:r.minimalMoveMouse,forbiddenIndices:new G,preDragTimeoutId:E,recentSnapScrollActivations:new Map})}function ae(){if((null==h?void 0:h.state)!==g.PreDrag)throw new m(g.PreDrag);clearTimeout(h.preDragTimeoutId);let e=h.from.containerEl[p];const t=e.options;"function"==typeof t.onBeforeDragStart&&t.onBeforeDragStart(h.from.containerEl,h.pickedEl),ie(!0,h.touchDrag),re(!1,h.touchDrag),h.pointerDownTarget&&h.pointerDownTarget.releasePointerCapture(h.pointerId),W||(W={htmlOvescrollBehavior:document.documentElement.style.overscrollBehavior,bodyOvescrollBehavior:document.body.style.overscrollBehavior},document.documentElement.style.overscrollBehavior="none",document.body.style.overscrollBehavior="none");const n=function(e){const t=e.pickedEl,n=t.cloneNode(!0);n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.margin="0",n.style.zIndex="10000000",n.style.pointerEvents="none",n.style.width=getComputedStyle(t).width,n.style.height=getComputedStyle(t).height;const o=-e.floatFromPointerOffset.x,r=-e.floatFromPointerOffset.y;n.style.transformOrigin=`${o}px ${r}px`;const i=e.currentPointerPos.x+e.floatFromPointerOffset.x,l=e.currentPointerPos.y+e.floatFromPointerOffset.y;return n.style.transform=`translate(${i}px,${l}px) scale(${e.floatElScale})`,n.classList.add("drag-float-item"),document.body.appendChild(n),n}(h);var o;"function"==typeof t.onFloatElementCreated&&t.onFloatElementCreated(n,h.from.containerEl,h.pickedEl),h.dragKind===b.Move&&((o=h.pickedEl).style.visibility="hidden",o.style.opacity="0",o.style.pointerEvents="none",o.classList.add("drag-active-item"),O(h.from.containerEl,h.from.index,P(h.from.containerEl))),"function"==typeof t.onDragStart&&t.onDragStart(h.from.containerEl,h.pickedEl),navigator.vibrate&&e.options.dragStartVibration&&navigator.vibrate(e.options.dragStartVibration),v(Object.assign(Object.assign({},h),{state:g.PendingDrag,floatEl:n,floatElPos:{x:h.currentPointerPos.x+h.floatFromPointerOffset.x,y:h.currentPointerPos.y+h.floatFromPointerOffset.y}}));const r={clientX:h.currentPointerPos.x,clientY:h.currentPointerPos.y};e.options.keepPositionOnDragStart&&Oe(e,r,!0,h.from.index,h.dragKind===b.Move)||Ee(r),0===ye&&(ye=requestAnimationFrame(xe))}function ce(e){h&&1!==e.touches.length&&Ce(!1)}function se(e){Ce(!1)}function de(e){Ce(!1)}function ue(e){if((null==h?void 0:h.state)!==g.PreDrag)throw new m(g.PreDrag);if(e.pointerId!==h.pointerId)return;const t=h.currentPointerPos.x=e.clientX,n=h.currentPointerPos.y=e.clientY;let o=t-h.pickupPointerPos.x,r=n-h.pickupPointerPos.y,i=o*o+r*r;const l=h.minimalMoveMouse;i>l*l&&ae()}function fe(e){if((null==h?void 0:h.state)!==g.PreDrag)throw new m(g.PreDrag);e.pointerId===h.pointerId&&Ce(!1)}function pe(e){Ce(!1)}function ge(e){e.cancelable&&e.preventDefault();const t=e.touches.item(0);t&&1===e.touches.length?ve(t):Ce(!1)}function me(e){e.pointerId===(null==h?void 0:h.pointerId)&&ve(e)}let he=null;function ve(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);e.clientY!==h.currentPointerPos.y&&(he=e.clientY>h.currentPointerPos.y?1:-1),h.currentPointerPos.x=e.clientX,h.currentPointerPos.y=e.clientY,h.floatElPos.x=h.currentPointerPos.x+h.floatFromPointerOffset.x,h.floatElPos.y=h.currentPointerPos.y+h.floatFromPointerOffset.y,ne||(ne=requestAnimationFrame(oe)),Ee(e)}function Ee(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);const t=h.to?h.to.containerEl[p].domDepth:-1;for(const n of function(e){return $.filter(t=>t.domDepth>e)}(t))if(Oe(n,e))return;const n=h.to;if(!n)return;!function(){if(U=[],!h)return void(N=null);const e=h.currentPointerPos.x,t=h.currentPointerPos.y;for(let n of q)n.horizontal&&(e<n.rect.left+ee?_(n,-1,0,(n.rect.left+ee-e)/ee):e>n.rect.right-ee?_(n,1,0,(e-n.rect.right+ee)/ee):h.recentSnapScrollActivations.delete(n.el)),n.vertical&&(t<n.rect.top+ee?_(n,0,-1,(n.rect.top+ee-t)/ee):t>n.rect.bottom-ee?_(n,0,1,(t-n.rect.bottom+ee)/ee):h.recentSnapScrollActivations.delete(n.el));0===U.length?N=null:j||(j=requestAnimationFrame(Q))}();const o=Pe(n.containerEl,e),r=h.forbiddenIndices.furthestAllowedInsertionIndex(n.containerEl,h.pickedEl,n.insertionIndex,o),i=K(n.containerEl,r);if(i===n.eventualIndex)return;let l=n.eventualIndex;n.eventualIndex=i,n.insertionIndex=r;const a=n.gapToPlaceholderOffset;De(n,!0),Le(),O(n.containerEl,l,i,n.gapToPlaceholderOffset!==a)}function Pe(e,t){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);let n=t.clientY-e.getClientRects()[0].top;const{containerEl:o,index:r}=h.from,i=h.dragKind===b.Move;let l=0,a=E(e),c=P(e);for(let t=a;t<c;++t){const a=e.children[t];if(!y(a))continue;if(!(a instanceof HTMLElement))continue;let c=t;if(i&&e===o){if(t===r)continue;t>r&&(l=h.pickedElToGapOffset,c-=1)}const s=M({containerEl:e,insertionIndex:t,eventualIndex:K(e,t),placeholderEl:z(e),gapToPlaceholderOffset:0}),d=a.offsetTop+l;if(n<=(d+Math.min(a.offsetHeight,s)+(d+a.offsetHeight))/2)return t}return c}let ye=0;function xe(){ye=(null==h?void 0:h.state)===g.PendingDrag?requestAnimationFrame(xe):0,(null==h?void 0:h.state)===g.PendingDrag&&h.to&&De(h.to,!1)}function De(t,n){let o=function({containerEl:t,eventualIndex:n,insertionIndex:o,placeholderEl:r}){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);const i=h.dragKind===b.Move;let l=null;for(l=t.children[o-1];l&&(l===h.pickedEl&&i||!y(l));l=l.previousElementSibling);if(!l)return e(t,"paddingTop")+e(r,"marginTop");const a=S(l,r),c=n!==o&&n>h.from.index?h.pickedElToGapOffset:0,s=l;return s.offsetTop+s.offsetHeight+a+c}(t);t.gapToPlaceholderOffset=M(t),f(t.placeholderEl,"translateY",o-e(t.placeholderEl,"marginTop")),n&&(f(t.placeholderEl,"scaleY",0,"base"),f(t.placeholderEl,"opacity",0,"base"))}function be(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);Ce(!1)}function Te(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);Se(),e.preventDefault(),e.stopPropagation()}function we(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);Ce(!1)}function Ie(e){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);e.pointerId===h.pointerId&&Se()}function Se(){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);document.addEventListener("click",F,!0),setTimeout(L,0),Ce(Boolean(h.to))}function Ce(e){var t,n,o;if((null==h?void 0:h.state)!==g.PreDrag&&(null==h?void 0:h.state)!==g.PendingDrag)throw new Error(`exitDrag called in wrong state: ${null==h?void 0:h.state}`);!e||h.state===g.PendingDrag&&h.to||(console.error("Exit drag called with execSort==true, but conditions are not met."),e=!1),h.state==g.PendingDrag?h.floatEl.remove():clearTimeout(h.preDragTimeoutId),function(){for(const e of X.values())e.remove();X.clear()}();let r,i=null;if(e&&h.state===g.PendingDrag&&h.to&&(h.dragKind!==b.Move||h.to.containerEl!==h.from.containerEl||h.to.eventualIndex!==h.from.index)){i=h.dragKind===b.Move?h.pickedEl:h.pickedEl.cloneNode(!0),r={dragExecuted:!0,item:h.pickedEl,from:h.from.containerEl,fromIndex:h.from.index,oldIndex:h.from.index,to:h.to.containerEl,eventualIndex:h.to.eventualIndex,insertionIndex:h.to.insertionIndex,newIndex:h.to.eventualIndex},h.dragKind===b.Move&&h.pickedEl.remove(),h.to.placeholderEl.remove();const{containerEl:e,index:t}=h.from,{containerEl:n,eventualIndex:o}=h.to,l=h.pickedElToGapOffset;if(h.dragKind===b.Move){const n=e=>e-l,o=e[p].options.animationTimeMs;for(let r of Array.from(e.children).slice(t))r instanceof HTMLElement&&f(r,"translateY",n,0,o)}o>=n.children.length?n.appendChild(i):n.children[o].before(i);const a=C(i)+k(i),c=e=>e+a,s=n[p].options.animationTimeMs;for(let e of Array.from(n.children).slice(o+1))e instanceof HTMLElement&&f(e,"translateY",c,0,s)}else{r={dragExecuted:!1,item:h.pickedEl,from:h.from.containerEl,fromIndex:h.from.index,oldIndex:h.from.index};for(let e of[h.from.containerEl,null===(t=h.to)||void 0===t?void 0:t.containerEl]){if(!e)continue;const t=e[p].options.animationTimeMs;for(const n of e.children)n instanceof HTMLElement&&f(n,"translateY","current",0,t)}}var l;if((l=h.pickedEl).classList.remove("drag-active-item"),l.style.visibility="",l.style.opacity="",l.style.pointerEvents="",h.state==g.PendingDrag){if(e||h.dragKind===b.Move){let e=null!=i?i:h.pickedEl,t=e.getClientRects()[0];const r=(null!==(o=null===(n=h.to)||void 0===n?void 0:n.containerEl)&&void 0!==o?o:h.from.containerEl)[p].options.floatToPlaceAnimationTimeMs;f(e,"translateX",h.floatElPos.x-t.left,0,r),f(e,"translateY",h.floatElPos.y-t.top,0,r),f(e,"scale",h.floatElScale,1,r)}if(h.to){Be(h.to.containerEl,!0);const e=h.to.containerEl[p].options;"function"==typeof e.onContainerLeft&&e.onContainerLeft(h.to.containerEl,h.pickedEl)}}re(!1,h.touchDrag),ie(!1,h.touchDrag),W&&(document.documentElement.style.overscrollBehavior=W.htmlOvescrollBehavior,document.body.style.overscrollBehavior=W.bodyOvescrollBehavior,W=null),te&&(document.body.style.userSelect=te.bodyUserSelect,document.body.style.webkitUserSelect=te.bodyWebkitUserSelect,document.body.style.webkitTouchCallout=te.bodyWebkitTouchCallout,te=null),v(null);const a=r.from[p].options;if(r.dragExecuted)if(r.to===r.from)"function"==typeof a.onInternalChange&&a.onInternalChange(r);else{"function"==typeof a.onDropToOtherContainer&&a.onDropToOtherContainer(r);const e=r.to[p].options;"function"==typeof e.onDropFromOtherContainer&&e.onDropFromOtherContainer(r)}"function"==typeof a.onDragFinished&&a.onDragFinished(r)}function ke(e){var t;const n=e.currentTarget,o=n[p];!function(e){e.domDepth=function(e){let t=0;for(e=e&&e.parentElement;e;e=e.parentElement)++t;return t}(e.el),-1===$.indexOf(e)&&($.push(e),$.sort(H))}(o),(null==h?void 0:h.state)===g.PendingDrag&&n!==(null===(t=h.to)||void 0===t?void 0:t.containerEl)&&Oe(o,e)}function Me(e){var t;const n=e.currentTarget;!function(e){let t;-1!==(t=$.indexOf(e))&&$.splice(t,1)}(n[p]),(null==h?void 0:h.state)===g.PendingDrag&&n===(null===(t=h.to)||void 0===t?void 0:t.containerEl)&&setTimeout(()=>{var e;(null==h?void 0:h.state)===g.PendingDrag&&n===(null===(e=h.to)||void 0===e?void 0:e.containerEl)&&Fe()},0)}function Oe(e,t,n,o,r){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);let i=e,l=i.el.getClientRects()[0];if(!i.options.allowDrop||!l)return!1;const a=h.currentPointerPos.x;if(n||a>=l.left+l.width*i.options.enterGuardLeft+i.options.enterGuardLeftPx&&a<=l.right-l.width*i.options.enterGuardRight-i.options.enterGuardRightPx){const e=null!=o?o:Pe(i.el,t),n=K(i.el,e);if(!h.forbiddenIndices.isForbiddenIndex(i.el,h.pickedEl,e))return function(e,t,n,o){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);h.to&&Fe(),q=function(e){let t=[];for(;e;e=e.parentElement){let n=getComputedStyle(e),o="auto"===n.overflowX||"scroll"===n.overflowX,r="auto"===n.overflowY||"scroll"===n.overflowY;if(!o&&!r)continue;let i=e.getClientRects()[0],l={left:i.left,top:i.top,right:i.right,bottom:i.bottom};t.push({el:e,rect:l,horizontal:o,vertical:r,snap:Boolean(e.dataset.omicronScrollSnap)})}return t}(e),h.to={containerEl:e,insertionIndex:t,eventualIndex:n,placeholderEl:z(e),gapToPlaceholderOffset:0},De(h.to,!0),Le(),function(e,t){f(e,"scaleY",t&&h&&I(h.pickedEl)/I(e)||0,"base"),f(e,"opacity",0,"base")}(h.to.placeholderEl,o),O(e,P(e),n);const r=e[p].options;"function"==typeof r.onContainerEntered&&r.onContainerEntered(h.from.containerEl,h.pickedEl)}(i.el,e,n,r),!0}return!1}function Fe(){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);if(!h.to)return;const e=h.to.containerEl;var t;f(t=h.to.placeholderEl,"scaleY","current",0),f(t,"opacity","current",0),O(e,h.to.eventualIndex,P(e)),Be(e),h.to=void 0;const n=e[p].options;"function"==typeof n.onContainerLeft&&n.onContainerLeft(e,h.pickedEl)}function Le(){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);if(!h.to)return;const e=h.to.containerEl;if(e&&e!==h.from.containerEl){const t=h.to.gapToPlaceholderOffset;f(e,"paddingBottom","current",(e,n)=>n+t,e[p].options.animatePadding?e[p].options.animationTimeMs:0)}}function Be(e,t){if((null==h?void 0:h.state)!==g.PendingDrag)throw new m(g.PendingDrag);e!==h.from.containerEl&&(t||!e[p].options.animatePadding?f(e,"paddingBottom","base"):f(e,"paddingBottom","current","base",e[p].options.animationTimeMs))}const Ye={init:function(e,t){if(e[p])return;const n=Object.assign(e,{[p]:{el:e,options:Object.assign(new R,t||{}),domDepth:0}});V(!0,document,[["dragover",B],["touchmove",B]]),V(!0,n,[["pointerdown",le],["pointerenter",ke],["pointerleave",Me]]),n[p].options.setWebkitTapHighlightColorTransparent&&"webkitTapHighlightColor"in n.style&&(n.style.webkitTapHighlightColor="transparent"),"static"===getComputedStyle(n).position&&(n.style.position="relative")},DragKind:b};export{Ye as default};
//# sourceMappingURL=omicron-dnd.js.map